var task,formName;function submitacymailingform(e,a){task=e,formName=a;var l="acymailing-captcha";a&&(l=a+"-captcha");var m=document.querySelector("#"+l+'[class="g-recaptcha"][data-size="invisible"]');if(m&&"object"==typeof grecaptcha){var n=m.getAttribute("grcID");return n||(n=grecaptcha.render(l,{sitekey:m.getAttribute("data-sitekey"),callback:"acySubmitSubForm",size:"invisible","expired-callback":"resetRecaptcha"}),m.setAttribute("grcID",n)),grecaptcha.getResponse(n)?acySubmitSubForm():(grecaptcha.execute(n),!1)}return acySubmitSubForm()}function resetRecaptcha(){var e="acymailing-captcha";formName&&(e=formName+"-captcha");var a=document.querySelector("#"+e+'[class="g-recaptcha"][data-size="invisible"]');if(a){var l=a.getAttribute("grcID");grecaptcha.reset(l)}}function acySubmitSubForm(){var e=document[formName];if("undefined"!=typeof acymailingModule)var a=acymailingModule.emailRegex;else a=/\@/i;if(e.elements||(e=e[0].elements["user[email]"]&&e[0].elements["user[email]"].value&&a.test(e[0].elements["user[email]"].value)?e[0]:e[e.length-1]),"optout"!=task&&(nameField=e.elements["user[name]"],nameField&&"undefined"!=typeof acymailingModule&&void 0!==acymailingModule["reqFields"+formName]&&acymailingModule["reqFields"+formName].indexOf("name")>=0&&(nameField.value==acymailingModule.NAMECAPTION||void 0!==acymailingModule["excludeValues"+formName]&&void 0!==acymailingModule["excludeValues"+formName].name&&nameField.value==acymailingModule["excludeValues"+formName].name||nameField.value.replace(/ /g,"").length<2)))return alert(acymailingModule.NAME_MISSING),nameField.className=nameField.className+" invalid",!1;var l=e.elements["user[email]"];if(l&&("undefined"!=typeof acymailingModule&&l.value==acymailingModule.EMAILCAPTION||(l.value=l.value.replace(/ /g,"")),!l||"undefined"!=typeof acymailingModule&&(l.value==acymailingModule.EMAILCAPTION||void 0!==acymailingModule["excludeValues"+formName]&&void 0!==acymailingModule["excludeValues"+formName].email&&l.value==acymailingModule["excludeValues"+formName].email)||!a.test(l.value)))return"undefined"!=typeof acymailingModule&&alert(acymailingModule.VALID_EMAIL),l.className=l.className+" invalid",!1;if(e.elements.hiddenlists.value.length<1){var m=!1,n=e.elements["subscription[]"];if(n&&(void 0===n.value||0==n.value.length)){for(b=0;b<n.length;b++)n[b].checked&&(m=!0);if(!m)return alert(acymailingModule.NO_LIST_SELECTED),!1}}if("optout"!=task&&"undefined"!=typeof acymailingModule){if(void 0!==acymailingModule["reqFields"+formName]&&acymailingModule["reqFields"+formName].length>0)for(var t=0;t<acymailingModule["reqFields"+formName].length;t++)if(elementName="user["+acymailingModule["reqFields"+formName][t]+"]",elementToCheck=e.elements[elementName],elementToCheck){var i=!1;if(void 0!==elementToCheck.value)if(" "==elementToCheck.value&&void 0!==e[elementName+"[]"])if(e[elementName+"[]"].checked)i=!0;else for(var s=0;s<e[elementName+"[]"].length;s++)(e[elementName+"[]"][s].checked||e[elementName+"[]"][s].selected)&&e[elementName+"[]"][s].value.length>0&&(i=!0);else elementToCheck.value.replace(/ /g,"").length>0&&(void 0!==acymailingModule["excludeValues"+formName]&&void 0!==acymailingModule["excludeValues"+formName][acymailingModule["reqFields"+formName][t]]&&acymailingModule["excludeValues"+formName][acymailingModule["reqFields"+formName][t]]==elementToCheck.value||(i=!0));else for(s=0;s<elementToCheck.length;s++)elementToCheck[s].checked&&elementToCheck[s].value.length>0&&(i=!0);if((elementToCheck.length>=1&&("none"==elementToCheck[0].parentElement.parentElement.style.display||"none"==elementToCheck[0].parentElement.parentElement.parentElement.style.display)||void 0===elementToCheck.length&&("none"==elementToCheck.parentElement.parentElement.style.display||"none"==elementToCheck.parentElement.parentElement.parentElement.style.display))&&(i=!0),!i)return elementToCheck.className=elementToCheck.className+" invalid",alert(acymailingModule["validFields"+formName][t]),!1}else{if(e.elements[elementName+"[day]"]&&e.elements[elementName+"[day]"].value<1||e.elements[elementName+"[month]"]&&e.elements[elementName+"[month]"].value<1||e.elements[elementName+"[year]"]&&e.elements[elementName+"[year]"].value<1902)return e.elements[elementName+"[day]"]&&e.elements[elementName+"[day]"].value<1&&(e.elements[elementName+"[day]"].className=e.elements[elementName+"[day]"].className+" invalid"),e.elements[elementName+"[month]"]&&e.elements[elementName+"[month]"].value<1&&(e.elements[elementName+"[month]"].className=e.elements[elementName+"[month]"].className+" invalid"),e.elements[elementName+"[year]"]&&e.elements[elementName+"[year]"].value<1902&&(e.elements[elementName+"[year]"].className=e.elements[elementName+"[year]"].className+" invalid"),alert(acymailingModule["validFields"+formName][t]),!1;if((e.elements[elementName+"[country]"]&&e.elements[elementName+"[country]"].value<1||e.elements[elementName+"[num]"]&&(e.elements[elementName+"[num]"].value<3||void 0!==acymailingModule["excludeValues"+formName]&&void 0!==acymailingModule["excludeValues"+formName][acymailingModule["reqFields"+formName][t]]&&acymailingModule["excludeValues"+formName][acymailingModule["reqFields"+formName][t]]==e.elements[elementName+"[num]"].value))&&(e.elements[elementName+"[country]"]&&"none"!=e.elements[elementName+"[country]"].parentElement.parentElement.style.display||e.elements[elementName+"[num]"]&&"none"!=e.elements[elementName+"[num]"].parentElement.parentElement.style.display))return e.elements[elementName+"[country]"]&&e.elements[elementName+"[country]"].value<1&&(e.elements[elementName+"[country]"].className=e.elements[elementName+"[country]"].className+" invalid"),e.elements[elementName+"[num]"]&&(e.elements[elementName+"[num]"].value<3||void 0!==acymailingModule["excludeValues"+formName]&&void 0!==acymailingModule["excludeValues"+formName][acymailingModule["reqFields"+formName][t]]&&acymailingModule["excludeValues"+formName][acymailingModule["reqFields"+formName][t]]==e.elements[elementName+"[num]"].value)&&(e.elements[elementName+"[num]"].className=e.elements[elementName+"[num]"].className+" invalid"),alert(acymailingModule["validFields"+formName][t]),!1}if("undefined"!=typeof acymailingModule&&void 0!==acymailingModule["checkFields"+formName]&&acymailingModule["checkFields"+formName].length>0)for(t=0;t<acymailingModule["checkFields"+formName].length;t++){if(elementName="user["+acymailingModule["checkFields"+formName][t]+"]",elementtypeToCheck=acymailingModule["checkFieldsType"+formName][t],elementToCheck=e.elements[elementName].value,void 0!==acymailingModule["excludeValues"+formName]){var c=acymailingModule["excludeValues"+formName][acymailingModule["checkFields"+formName][t]];if(void 0!==c&&elementToCheck==c)continue}switch(elementtypeToCheck){case"number":myregexp=new RegExp("^[0-9]*$");break;case"letter":myregexp=new RegExp("^[A-Za-zÀ-ſ ]*$");break;case"letnum":myregexp=new RegExp("^[0-9a-zA-ZÀ-ſ ]*$");break;case"regexp":myregexp=new RegExp(acymailingModule["checkFieldsRegexp"+formName][t])}if(!myregexp.test(elementToCheck))return alert(acymailingModule["validCheckFields"+formName][t]),!1}}var o=e.elements.acycaptcha;if(o&&o.value.length<1)return"undefined"!=typeof acymailingModule&&alert(acymailingModule.CAPTCHA_MISSING),o.className=o.className+" invalid",!1;if("optout"!=task){var u=e.terms;if(u&&!u.checked)return"undefined"!=typeof acymailingModule&&alert(acymailingModule.ACCEPT_TERMS),u.className=u.className+" invalid",!1;if("undefined"!=typeof acymailingModule&&void 0!==acymailingModule["excludeValues"+formName])for(var r in acymailingModule["excludeValues"+formName])acymailingModule["excludeValues"+formName].hasOwnProperty(r)&&e.elements["user["+r+"]"]&&e.elements["user["+r+"]"].value==acymailingModule["excludeValues"+formName][r]&&(e.elements["user["+r+"]"].value="")}if("undefined"!=typeof ga&&"optout"!=task?ga("send","pageview","subscribe"):"undefined"!=typeof ga&&ga("send","pageview","unsubscribe"),taskField=e.task,taskField.value=task,!e.elements.ajax||!e.elements.ajax.value||"0"==e.elements.ajax.value)return e.submit(),!1;var d=document.getElementById(formName),y=new FormData(d);d.className+=" acymailing_module_loading",d.style.filter="alpha(opacity=50)",d.style.opacity="0.5";var g=new XMLHttpRequest;return g.open("POST",d.action),g.onload=function(){var e="Ajax Request Failure",a="error";if(200===g.status){var l=JSON.parse(g.responseText);e=l.message,a=l.type}acymailingDisplayAjaxResponse(decodeURIComponent(e),a,formName)},g.send(y),!1}function acymailingDisplayAjaxResponse(e,a,l){var m=document.getElementById("acymailing_togglemodule_"+l);m&&m.className.indexOf("acyactive")>-1&&(m.parentElement.parentElement.childNodes[1].style.height="");var n=document.querySelectorAll("#acymailing_fulldiv_"+l+" .responseContainer")[0];if(void 0===n){n=document.createElement("div");var t=document.getElementById("acymailing_fulldiv_"+l);t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),oldContainerHeight="0px"}else oldContainerHeight=n.style.height;n.className="responseContainer";var i=document.getElementById(l),s=i.className,c="acymailing_module_loading",o=s.replace(" "+c,"",s);o==s&&(o=s.replace(c+" ","",s)),o==s&&(o=s.replace(c,"",s)),i.className=o,n.innerHTML=e,"success"==a?n.className+=" acymailing_module_success":(n.className+=" acymailing_module_error",i.style.opacity="1"),newContainerHeight=n.style.height,i.style.display="none",n.className+=" slide_open"}